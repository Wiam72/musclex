

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>How it works &mdash; MuscleX  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="How to use" href="Equator--How-to-use.html" />
    <link rel="prev" title="The Equatorial Diffraction Pattern from Striated Muscle" href="The-Equatorial-Diffraction-Pattern-from-Striated-Muscle.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> MuscleX
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Muscle X</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Installation/index.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Application Suite</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Equator</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Equator-(eq).html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="The-Equatorial-Diffraction-Pattern-from-Striated-Muscle.html">The Equatorial Diffraction Pattern from Striated Muscle</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">How it works</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#image-processing-and-fitting-model">Image processing and fitting model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Equator--How-to-use.html">How to use</a></li>
<li class="toctree-l3"><a class="reference internal" href="Blank-Image-and-Mask.html">Blank Image and Mask</a></li>
<li class="toctree-l3"><a class="reference internal" href="Equator--Summary.html">Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../QuadrantFolding/index.html">Quadrant Folding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ProjectionTraces/index.html">Projection Traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ScanningDiffraction/index.html">Scanning Diffraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ImageMerger/index.html">Image Merger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DiffractionCentroids/index.html">Diffraction Centroids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DDFProcessor/index.html">DDF Processor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Calibration-Settings.html">Calibration Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Image-Processing-Functions.html">Image Processing Functions</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MuscleX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Application Suite</a> &raquo;</li>
        
          <li><a href="index.html">Equator</a> &raquo;</li>
        
      <li>How it works</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/AppSuite/Equator/Equator--How-it-works.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="how-it-works">
<span id="how-it-works"></span><h1>How it works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h1>
<p>When an image is selected, if there is an image in the same folder named “calibration.tif”, the calibration settings window will pop up (How to set calibration settings will be explained in the next section). If there’s no calibration image or it’s set already, the image will be processed automatically with the default parameters. However, if the image has ever been processed with the same version of the program, the cache will be downloaded, so the image won’t be processed again.</p>
<div class="section" id="image-processing-and-fitting-model">
<span id="image-processing-and-fitting-model"></span><h2>Image processing and fitting model<a class="headerlink" href="#image-processing-and-fitting-model" title="Permalink to this headline">¶</a></h2>
<p>The program will process an image by going through multiple processes in the order</p>
<div class="section" id="find-center">
<span id="find-center"></span><h3>1. <a class="reference external" href="../Image-Processing-Functions.html#finding-center">Find Center</a><a class="headerlink" href="#find-center" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="calculate-rotation-angle">
<span id="calculate-rotation-angle"></span><h3>2. <a class="reference external" href="../Image-Processing-Functions.html#calculate-rotation-angle">Calculate Rotation Angle</a><a class="headerlink" href="#calculate-rotation-angle" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="calculate-r-min">
<span id="calculate-r-min"></span><h3>3. <a class="reference external" href="../Image-Processing-Functions.html#calculate-r-min">Calculate R-min</a><a class="headerlink" href="#calculate-r-min" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="calculate-box-width">
<span id="calculate-box-width"></span><h3>4. Calculate Box Width<a class="headerlink" href="#calculate-box-width" title="Permalink to this headline">¶</a></h3>
<p>The image will be rotated by the rotation angle determined above, and the area inside R-min removed as in this image. The image will be cropped by using R-min x 1.5.</p>
<p><img alt="-" src="../../_images/boxwidth_1.png" /></p>
<p>Then, the program will find the horizontal histogram from this image, calculate the background assuming a convex hull function to the histogram, and the integrated area will be selected as between the start and end point of the histogram. From the image above, the horizontal histogram was</p>
<p><img alt="-" src="../../_images/boxwidth_2.png" /></p>
</div>
<div class="section" id="get-intensity-histogram">
<span id="get-intensity-histogram"></span><h3>5. Get Intensity Histogram<a class="headerlink" href="#get-intensity-histogram" title="Permalink to this headline">¶</a></h3>
<p>When integrated area is calculated, the program will produce a histogram from the rotated image inside the integrated area. (If the blank image and mask is set, the original image will be subtracted by the blank image before rotation)</p>
<p><img alt="-" src="../../_images/hist.png" /></p>
</div>
<div class="section" id="apply-convex-hull-to-intensity-histogram">
<span id="apply-convex-hull-to-intensity-histogram"></span><h3>6. Apply Convex hull to intensity histogram<a class="headerlink" href="#apply-convex-hull-to-intensity-histogram" title="Permalink to this headline">¶</a></h3>
<p>The original histogram will be split into left and right sides. Then, the convex hull to each half pattern will be calculated in order to remove the background by using R-min as a starting point.</p>
<p><img alt="-" src="../../_images/convexhull.png" /></p>
</div>
<div class="section" id="find-diffraction-peaks">
<span id="find-diffraction-peaks"></span><h3>7. Find Diffraction Peaks<a class="headerlink" href="#find-diffraction-peaks" title="Permalink to this headline">¶</a></h3>
<p>The program will find peaks from left and right histograms which have had the convex hull background subtracted. This process will find all locations of the peaks. If the image is noisy, it is possible that the program will find too many peaks. ( In the image below, the program found only 2 peaks because the image was not noisy, so it worked very well )</p>
<p><img alt="-" src="../../_images/find_peaks.png" /></p>
</div>
<div class="section" id="managing-diffraction-peaks">
<span id="managing-diffraction-peaks"></span><h3>8. Managing Diffraction Peaks<a class="headerlink" href="#managing-diffraction-peaks" title="Permalink to this headline">¶</a></h3>
<p>This process prepares and corrects the background-subtracted, intensity histogram before fitting a model. It is possible that the program found peaks from noise, misplaced peaks, or both false positive peaks and false negative peaks. Therefore, these peaks need to be re-positioned in case this process fails. The algorithm  will try to find first symmetric peaks, and find S<sub>10</sub> which is the distance from center to the first peak on the equator. After that, all peak locations will be calculated by using S<sub>10</sub> and theta(h,k). The number of peaks on each side to be fit needs to be specified by the user (default and minimum is 2)</p>
</div>
<div class="section" id="fit-model">
<span id="fit-model"></span><h3>9. Fit Model<a class="headerlink" href="#fit-model" title="Permalink to this headline">¶</a></h3>
<p>The program will fit the model to the histogram by using the specified model (currently Gaussian and Voigtian models are supported), initial S<sub>10</sub>,and the area of the reflection peaks. Finally, we will obtain the new parameters we want from the fitting results. This will include the area of each peak, S10, sigma D, sigma S, gamma, and  I<sub>11</sub>/I<sub>10</sub>. However, if you see only 4 reflection from the pattern (Only I<sub>11</sub> and I<sub>10</sub> on each side), it will be overdetermined if you use Voigt as a fitting model. To solve this problem, sigma S or gamma should be fixed.</p>
<p>If there are some parameters that need to be configured manually to obtain good fits, the program will run these processes again, but it will not start from the beginning. Instead, it will start from the process after the manual one. For example, if the Box Width is set manually, the program will run processes from Get Intensity Histogram to Fit Model because the center, rotation angle and r-min do not need to be recalculated.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Equator--How-to-use.html" class="btn btn-neutral float-right" title="How to use" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="The-Equatorial-Diffraction-Pattern-from-Striated-Muscle.html" class="btn btn-neutral" title="The Equatorial Diffraction Pattern from Striated Muscle" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, BioCAT.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>